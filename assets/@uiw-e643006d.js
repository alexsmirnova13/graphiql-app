import{a as _,_ as V}from"./@babel-fdd30412.js";import{r,j as w}from"./react-f80be28f.js";import{c as q,d as J,s as P,h as Q,f as X,a as Y,l as Z,b as $,e as ee,g as te,i as ae,j as ie,k as se,m as ne,E as N,n as re,o as le,p as fe,q as oe,r as ce,t as he,u as ue,v as de,w as me,x as ge,y as F,z as pe,A as y,B as Se,C as ye,D as be,F as xe,S as ve}from"./@codemirror-3112add7.js";var I=function(e){e===void 0&&(e={});var i=[];e.closeBracketsKeymap!==!1&&(i=i.concat(q)),e.defaultKeymap!==!1&&(i=i.concat(J)),e.searchKeymap!==!1&&(i=i.concat(P)),e.historyKeymap!==!1&&(i=i.concat(Q)),e.foldKeymap!==!1&&(i=i.concat(X)),e.completionKeymap!==!1&&(i=i.concat(Y)),e.lintKeymap!==!1&&(i=i.concat(Z));var t=[];return e.lineNumbers!==!1&&t.push($()),e.highlightActiveLineGutter!==!1&&t.push(ee()),e.highlightSpecialChars!==!1&&t.push(te()),e.history!==!1&&t.push(ae()),e.foldGutter!==!1&&t.push(ie()),e.drawSelection!==!1&&t.push(se()),e.dropCursor!==!1&&t.push(ne()),e.allowMultipleSelections!==!1&&t.push(N.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&t.push(re()),e.syntaxHighlighting!==!1&&t.push(le(pe,{fallback:!0})),e.bracketMatching!==!1&&t.push(fe()),e.closeBrackets!==!1&&t.push(oe()),e.autocompletion!==!1&&t.push(ce()),e.rectangularSelection!==!1&&t.push(he()),e.crosshairCursor!==!1&&t.push(ue()),e.highlightActiveLine!==!1&&t.push(de()),e.highlightSelectionMatches!==!1&&t.push(me()),e.tabSize&&typeof e.tabSize=="number"&&t.push(ge.of(" ".repeat(e.tabSize))),t.concat([F.of(i.flat())]).filter(Boolean)},Ee=function(e){e===void 0&&(e={});var{indentWithTab:i=!0,editable:t=!0,readOnly:u=!1,theme:h="light",placeholder:f="",basicSetup:c=!0}=e,n=[],d=y.theme({"&":{backgroundColor:"#fff"}},{dark:!1});switch(i&&n.unshift(F.of([Se])),c&&(typeof c=="boolean"?n.unshift(I()):n.unshift(I(c))),f&&n.unshift(ye(f)),h){case"light":n.push(d);break;case"dark":n.push(be);break;case"none":break;default:n.push(h);break}return t===!1&&n.push(y.editable.of(!1)),u&&n.push(N.readOnly.of(!0)),[...n]},ke=a=>({line:a.state.doc.lineAt(a.state.selection.main.from),lineCount:a.state.doc.lines,lineBreak:a.state.lineBreak,length:a.state.doc.length,readOnly:a.state.readOnly,tabSize:a.state.tabSize,selection:a.state.selection,selectionAsSingle:a.state.selection.asSingle().main,ranges:a.state.selection.ranges,selectionCode:a.state.sliceDoc(a.state.selection.main.from,a.state.selection.main.to),selections:a.state.selection.ranges.map(e=>a.state.sliceDoc(e.from,e.to)),selectedText:a.state.selection.ranges.some(e=>!e.empty)}),R=xe.define();function Ce(a){var{value:e,selection:i,onChange:t,onStatistics:u,onCreateEditor:h,onUpdate:f,extensions:c=[],autoFocus:n,theme:d="light",height:E="",minHeight:m="",maxHeight:k="",placeholder:C="",width:W="",minWidth:K="",maxWidth:O="",editable:T=!0,readOnly:B=!1,indentWithTab:H=!0,basicSetup:L=!0,root:j,initialState:b}=a,[g,M]=r.useState(),[s,o]=r.useState(),[p,S]=r.useState(),z=y.theme({"&":{height:E,minHeight:m,maxHeight:k,width:W,minWidth:K,maxWidth:O}}),D=y.updateListener.of(l=>{if(l.docChanged&&typeof t=="function"&&!l.transactions.some(U=>U.annotation(R))){var v=l.state.doc,A=v.toString();t(A,l)}u&&u(ke(l))}),G=Ee({theme:d,editable:T,readOnly:B,placeholder:C,indentWithTab:H,basicSetup:L}),x=[D,z,...G];return f&&typeof f=="function"&&x.push(y.updateListener.of(f)),x=x.concat(c),r.useEffect(()=>{if(g&&!p){var l={doc:e,selection:i,extensions:x},v=b?N.fromJSON(b.json,l,b.fields):N.create(l);if(S(v),!s){var A=new y({state:v,parent:g,root:j});o(A),h&&h(A,v)}}return()=>{s&&(S(void 0),o(void 0))}},[g,p]),r.useEffect(()=>M(a.container),[a.container]),r.useEffect(()=>()=>{s&&(s.destroy(),o(void 0))},[s]),r.useEffect(()=>{n&&s&&s.focus()},[n,s]),r.useEffect(()=>{s&&s.dispatch({effects:ve.reconfigure.of(x)})},[d,c,E,m,k,W,K,O,C,T,B,H,L,t,f]),r.useEffect(()=>{if(e!==void 0){var l=s?s.state.doc.toString():"";s&&e!==l&&s.dispatch({changes:{from:0,to:l.length,insert:e||""},annotations:[R.of(!0)]})}},[e,s]),{state:p,setState:S,view:s,setView:o,container:g,setContainer:M}}var We=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Ke=r.forwardRef((a,e)=>{var{className:i,value:t="",selection:u,extensions:h=[],onChange:f,onStatistics:c,onCreateEditor:n,onUpdate:d,autoFocus:E,theme:m="light",height:k,minHeight:C,maxHeight:W,width:K,minWidth:O,maxWidth:T,basicSetup:B,placeholder:H,indentWithTab:L,editable:j,readOnly:b,root:g,initialState:M}=a,s=_(a,We),o=r.useRef(null),{state:p,view:S,container:z}=Ce({container:o.current,root:g,value:t,autoFocus:E,theme:m,height:k,minHeight:C,maxHeight:W,width:K,minWidth:O,maxWidth:T,basicSetup:B,placeholder:H,indentWithTab:L,editable:j,readOnly:b,selection:u,onChange:f,onStatistics:c,onCreateEditor:n,onUpdate:d,extensions:h,initialState:M});if(r.useImperativeHandle(e,()=>({editor:o.current,state:p,view:S}),[o,z,p,S]),typeof t!="string")throw new Error("value must be typeof string but got "+typeof t);var D=typeof m=="string"?"cm-theme-"+m:"cm-theme";return w.jsx("div",V({ref:o,className:""+D+(i?" "+i:"")},s))});Ke.displayName="CodeMirror";export{Ke as R};
